# سجل القرارات المعمارية - Arabic Science Hub

## نظرة عامة
هذا الملف يوثق جميع القرارات المعمارية والتقنية المهمة المتخذة في مشروع Arabic Science Hub، مع تبرير كل قرار والبدائل المدروسة.

---

## القرار #001: اختيار Next.js كإطار عمل أساسي
**التاريخ:** 2025-01-08  
**الحالة:** مقبول  

### السياق
نحتاج إلى إطار عمل حديث وقابل للتوسع لبناء منصة علمية تفاعلية.

### القرار
اختيار Next.js 15 مع TypeScript كإطار العمل الأساسي للمشروع.

### المبررات
- دعم ممتاز لـ Server-Side Rendering (SSR) و Static Site Generation (SSG)
- نظام بيئي غني مع مكتبات React
- أداء ممتاز وتحسين تلقائي للصور والخطوط
- دعم مدمج لـ TypeScript
- مجتمع نشط ووثائق شاملة
- دعم Turbopack للتطوير السريع

### البدائل المدروسة
- **Nuxt.js**: ممتاز لكن أقل انتشاراً في المجتمع العربي
- **SvelteKit**: حديث وسريع لكن نظام بيئي أصغر
- **Remix**: قوي لكن أقل نضجاً من Next.js

### العواقب
- تطوير سريع ومرن
- أداء ممتاز للمستخدم النهائي
- سهولة النشر والصيانة
- منحنى تعلم معقول للفريق

---

## القرار #002: استخدام PostgreSQL كقاعدة بيانات أساسية
**التاريخ:** 2025-01-08  
**الحالة:** مقبول  

### السياق
نحتاج إلى قاعدة بيانات قوية تدعم العلاقات المعقدة والبحث النصي المتقدم.

### القرار
استخدام PostgreSQL مع Prisma ORM.

### المبررات
- دعم ممتاز للبحث النصي الكامل (Full-Text Search)
- أداء عالي مع البيانات الكبيرة
- دعم JSON وأنواع البيانات المتقدمة
- موثوقية عالية ومعايير ACID
- دعم مدمج للبحث متعدد اللغات
- تكامل ممتاز مع Prisma

### البدائل المدروسة
- **MySQL**: أقل دعماً للبحث النصي المتقدم
- **MongoDB**: مرونة أكبر لكن أقل ضماناً للاتساق
- **SQLite**: بساطة أكبر لكن محدودية في التوسع

### العواقب
- قدرات بحث متقدمة للمحتوى العربي
- أداء ممتاز مع نمو البيانات
- سهولة إدارة العلاقات المعقدة

---

## القرار #003: اعتماد tRPC للتواصل بين العميل والخادم
**التاريخ:** 2025-01-08  
**الحالة:** مقبول  

### السياق
نحتاج إلى طريقة آمنة وفعالة للتواصل بين الواجهة الأمامية والخلفية مع ضمان نوع البيانات.

### القرار
استخدام tRPC مع Zod للتحقق من صحة البيانات.

### المبررات
- Type safety كاملة من العميل إلى الخادم
- تجربة تطوير ممتازة مع IntelliSense
- أداء عالي مع HTTP batching
- تكامل مثالي مع TypeScript
- تحقق تلقائي من صحة البيانات مع Zod

### البدائل المدروسة
- **GraphQL**: مرونة أكبر لكن تعقيد إضافي
- **REST API**: بساطة أكبر لكن فقدان Type Safety
- **gRPC**: أداء ممتاز لكن تعقيد في التطوير

### العواقب
- تطوير أسرع مع أخطاء أقل
- صيانة أسهل للكود
- أداء ممتاز للتطبيق

---

## القرار #004: استخدام TailwindCSS للتصميم
**التاريخ:** 2025-01-08  
**الحالة:** مقبول  

### السياق
نحتاج إلى نظام تصميم مرن وقابل للتخصيص يدعم اللغة العربية.

### القرار
استخدام TailwindCSS مع ShadCN/UI كمكتبة مكونات.

### المبررات
- مرونة كاملة في التصميم
- حجم ملف CSS محسّن في الإنتاج
- دعم ممتاز للـ RTL (Right-to-Left)
- نظام بيئي غني من المكونات الجاهزة
- سهولة التخصيص والصيانة

### البدائل المدروسة
- **Styled Components**: مرونة أكبر لكن أداء أقل
- **Material-UI**: مكونات جاهزة لكن مرونة أقل
- **Chakra UI**: توازن جيد لكن نظام بيئي أصغر

### العواقب
- تطوير سريع للواجهات
- تصميم متسق عبر التطبيق
- دعم ممتاز للغة العربية

---

## القرار #005: إعداد بيئة اختبار شاملة
**التاريخ:** 2025-01-08  
**الحالة:** مقبول  

### السياق
نحتاج إلى ضمان جودة الكود وموثوقية التطبيق.

### القرار
استخدام Vitest للاختبارات الوحدة و Playwright للاختبارات الشاملة.

### المبررات
- Vitest: سرعة عالية وتكامل ممتاز مع Vite
- Playwright: دعم متعدد المتصفحات وموثوقية عالية
- تغطية شاملة لجميع أجزاء التطبيق
- تكامل مع CI/CD

### البدائل المدروسة
- **Jest + Testing Library**: خيار تقليدي لكن أبطأ
- **Cypress**: واجهة أفضل لكن أداء أقل من Playwright

### العواقب
- ثقة أكبر في استقرار التطبيق
- تطوير أسرع مع اكتشاف مبكر للأخطاء
- صيانة أسهل للكود

---

## القرار #006: استخدام PostgreSQL محلياً بدلاً من Docker
**التاريخ:** 2025-01-08  
**الحالة:** مقبول مؤقتاً  

### السياق
واجهنا مشاكل تقنية مع Docker في بيئة التطوير الحالية.

### القرار
تثبيت PostgreSQL محلياً في بيئة التطوير.

### المبررات
- تجنب مشاكل الشبكة والأذونات في Docker
- سرعة أكبر في الوصول لقاعدة البيانات
- بساطة في الإعداد والصيانة

### البدائل المدروسة
- **Docker Compose**: الخيار المفضل لكن واجه مشاكل تقنية
- **قاعدة بيانات سحابية**: تعقيد إضافي في التطوير

### العواقب
- إعداد أسرع لبيئة التطوير
- قد نحتاج للعودة لـ Docker في الإنتاج
- تباين محتمل بين بيئات التطوير والإنتاج

**ملاحظة:** هذا قرار مؤقت وسنعيد تقييمه لاحقاً.

---

## القرارات المستقبلية المطلوبة

### 1. نظام المصادقة والتفويض
- NextAuth.js vs Auth0 vs Supabase Auth
- استراتيجية إدارة الجلسات
- تكامل مع الهويات الأكاديمية (ORCID)

### 2. نظام إدارة الملفات
- تخزين محلي vs خدمات سحابية
- معالجة ملفات PDF والمرفقات
- نظام النسخ الاحتياطي

### 3. نظام البحث المتقدم
- Elasticsearch vs PostgreSQL Full-Text Search
- دعم البحث الدلالي
- فهرسة المحتوى العربي

### 4. نظام التنبيهات والإشعارات
- إشعارات في الوقت الفعلي
- إشعارات البريد الإلكتروني
- تكامل مع منصات التواصل

### 5. نظام التحليلات والمقاييس
- تتبع سلوك المستخدمين
- مقاييس الأداء
- تحليل المحتوى والتفاعل

---

*آخر تحديث: 2025-01-08*



## قرار معماري #4: تطوير نظام المصادقة والتأمين
**التاريخ:** 3 أغسطس 2025  
**الحالة:** مقبول ومطبق

### السياق
تطلب المشروع تطوير نظام مصادقة شامل يدعم Google OAuth مع صفحات مخصصة وحماية للمسارات الخاصة.

### القرار
تم تطوير نظام مصادقة متكامل يشمل:
1. صفحات مصادقة مخصصة (signin, signup, profile)
2. NextAuth.js middleware للحماية التلقائية
3. مكتبة مساعدة للتحقق من الصلاحيات
4. دعم كامل للعربية مع RTL

### المبررات
- **الأمان**: Middleware يوفر حماية تلقائية دون تكرار الكود
- **تجربة المستخدم**: صفحات مخصصة تدعم العربية وتوفر تجربة متسقة
- **القابلية للصيانة**: مكتبة auth منفصلة تسهل إدارة الصلاحيات
- **الأداء**: استخدام JWT يقلل من استعلامات قاعدة البيانات

### البدائل المرفوضة
- استخدام صفحات NextAuth.js الافتراضية (لا تدعم العربية)
- التحقق اليدوي في كل صفحة (يزيد التعقيد والأخطاء)
- استخدام مكتبة مصادقة أخرى (NextAuth.js الأكثر نضجاً مع Next.js)

### العواقب
- **إيجابية**: نظام آمن وقابل للتوسع مع دعم كامل للعربية
- **سلبية**: اعتماد على NextAuth.js (لكنه مقبول لنضج المكتبة)
- **محايدة**: حجم الكود زاد قليلاً لكن مع فوائد كبيرة في الأمان والصيانة

---

## قرار معماري #5: ربط المشروع بـ GitHub
**التاريخ:** 3 أغسطس 2025  
**الحالة:** مقبول ومطبق

### السياق
تطلب المشروع ربطه بمستودع GitHub عام لتسهيل التعاون والنشر.

### القرار
تم إنشاء مستودع عام على GitHub مع:
1. استخدام Personal Access Token للمصادقة
2. commit احترافي يوضح جميع التغييرات
3. tag للإصدار v0.1-auth-ready
4. وصف شامل للمستودع باللغة العربية

### المبررات
- **التعاون**: يسهل مشاركة الكود مع فريق التطوير
- **النسخ الاحتياطي**: حفظ آمن للكود في السحابة
- **التتبع**: تاريخ كامل للتغييرات والإصدارات
- **الشفافية**: مستودع عام يعكس طبيعة المشروع العلمي المفتوح

### البدائل المرفوضة
- مستودع خاص (المشروع علمي ومفتوح المصدر)
- منصات أخرى مثل GitLab (GitHub الأكثر انتشاراً)
- عدم استخدام نظام تحكم بالإصدارات (غير مقبول لمشروع بهذا الحجم)

### العواقب
- **إيجابية**: سهولة التعاون والمشاركة والنشر
- **سلبية**: الكود مكشوف للعامة (لكن هذا مطلوب)
- **محايدة**: اعتماد على GitHub (منصة موثوقة ومستقرة)


## قرار معماري #6: تطوير صفحات الأوراق البحثية
**التاريخ:** 3 أغسطس 2025  
**الحالة:** مقبول ومطبق

### السياق
تطلب المشروع تطوير صفحات شاملة لتصفح وعرض الأوراق البحثية مع إمكانيات البحث والفلترة والترقيم.

### القرار
تم تطوير نظام متكامل يشمل:
1. مكونات UI قابلة لإعادة الاستخدام (PaperCard, SearchBar, CategoryFilter, PaperList, Pagination)
2. صفحة تصفح شاملة مع البحث والفلترة والترقيم
3. صفحة تفاصيل الورقة مع عرض كامل للمحتوى
4. تحديث APIs لدعم page-based pagination

### المبررات
- **تجربة المستخدم**: واجهة سهلة ومألوفة للمستخدمين العرب
- **الأداء**: تحميل تدريجي للبيانات مع الترقيم
- **القابلية للصيانة**: مكونات منفصلة وقابلة لإعادة الاستخدام
- **التوسع**: بنية تدعم إضافة ميزات جديدة بسهولة

### البدائل المرفوضة
- استخدام cursor-based pagination (أقل سهولة للمستخدمين)
- دمج جميع الوظائف في صفحة واحدة (يزيد التعقيد)
- استخدام مكتبات UI جاهزة (لا تدعم العربية بشكل مثالي)

### العواقب
- **إيجابية**: واجهة مستخدم محسنة مع دعم كامل للعربية
- **إيجابية**: مكونات قابلة لإعادة الاستخدام في صفحات أخرى
- **سلبية**: زيادة في عدد الملفات (لكن مع فوائد في التنظيم)
- **محايدة**: تغيير في نمط pagination (لكن مع تحسن في UX)

---

## قرار معماري #7: تحديث APIs لدعم الترقيم وتنسيق البيانات
**التاريخ:** 3 أغسطس 2025  
**الحالة:** مقبول ومطبق

### السياق
احتاجت المكونات الجديدة لتنسيق محدد للبيانات ونظام ترقيم مختلف عن الموجود.

### القرار
تم تحديث papers API ليشمل:
1. تغيير من cursor-based إلى page-based pagination
2. تنسيق البيانات في API layer بدلاً من Frontend
3. إضافة superjson لتحسين نقل البيانات
4. إرجاع metadata إضافية (total, totalPages)

### المبررات
- **فصل الاهتمامات**: API يقدم البيانات بالشكل المطلوب
- **الأداء**: تقليل المعالجة في الواجهة الأمامية
- **الثبات**: ضمان تناسق البيانات عبر التطبيق
- **سهولة الاستخدام**: page-based pagination أسهل للمستخدمين

### البدائل المرفوضة
- الاحتفاظ بـ cursor-based pagination (أقل سهولة)
- تنسيق البيانات في Frontend (يزيد التعقيد)
- عدم استخدام superjson (أداء أقل في نقل البيانات)

### العواقب
- **إيجابية**: تحسن في أداء وسهولة استخدام الواجهة
- **إيجابية**: كود أنظف وأكثر تنظيماً
- **سلبية**: تغيير في API contracts (لكن مع تحسن في الوظائف)
- **محايدة**: إضافة dependency جديدة (superjson موثوقة ومستقرة)



## قرار معماري #8: تطوير نظام التفاعل الديناميكي
**التاريخ:** 3 أغسطس 2025  
**الحالة:** مقبول ومطبق

### السياق
تطلب المشروع نظام تفاعل شامل يشمل الإعجابات، التعليقات، حفظ الأوراق، والإشعارات لزيادة مشاركة المستخدمين.

### القرار
تم تطوير نظام تفاعل متكامل يشمل:
1. نموذج Notification في قاعدة البيانات مع أنواع مختلفة من الإشعارات
2. interactions API router شامل لجميع أنواع التفاعل
3. مكونات UI تفاعلية مع optimistic updates
4. صفحات مخصصة للمحفوظات والإشعارات
5. تكامل كامل في صفحة تفاصيل الورقة

### المبررات
- **تجربة مستخدم محسنة**: تفاعل فوري مع optimistic UI
- **زيادة المشاركة**: نظام إشعارات يشجع العودة للمنصة
- **تنظيم أفضل**: فصل منطق التفاعلات في router منفصل
- **مرونة**: دعم أنواع مختلفة من التفاعل والإشعارات

### البدائل المرفوضة
- استخدام مكتبات تفاعل جاهزة (لا تدعم العربية بشكل مثالي)
- دمج التفاعلات في papers router (يزيد التعقيد)
- عدم استخدام optimistic UI (تجربة مستخدم أبطأ)

### العواقب
- **إيجابية**: تجربة مستخدم سريعة ومتجاوبة
- **إيجابية**: نظام إشعارات يزيد من مشاركة المستخدمين
- **إيجابية**: مكونات قابلة لإعادة الاستخدام
- **سلبية**: زيادة في تعقيد قاعدة البيانات (لكن مع فوائد كبيرة)

---

## قرار معماري #9: استخدام Optimistic UI للتفاعلات
**التاريخ:** 3 أغسطس 2025  
**الحالة:** مقبول ومطبق

### السياق
التفاعلات مثل الإعجاب والحفظ تحتاج لاستجابة فورية لتحسين تجربة المستخدم.

### القرار
تم تطبيق Optimistic UI في:
1. زر الإعجاب: تحديث فوري للحالة والعداد
2. زر الحفظ: تغيير فوري للأيقونة والنص
3. معالجة أخطاء: إرجاع الحالة السابقة عند فشل العملية
4. مؤشرات تحميل: إظهار حالة التحميل أثناء العملية

### المبررات
- **استجابة فورية**: لا انتظار لاستجابة الخادم
- **تجربة مستخدم أفضل**: شعور بالسرعة والتجاوب
- **معالجة أخطاء ذكية**: إرجاع الحالة عند الفشل
- **أداء محسن**: تقليل الوقت المدرك للعمليات

### البدائل المرفوضة
- انتظار استجابة الخادم (تجربة أبطأ)
- عدم معالجة الأخطاء (تجربة مستخدم سيئة)
- استخدام loading states فقط (أقل تفاعلية)

### العواقب
- **إيجابية**: تجربة مستخدم سريعة ومتجاوبة
- **إيجابية**: شعور بالأداء العالي للتطبيق
- **سلبية**: تعقيد إضافي في إدارة الحالة (لكن مع مكتبات مساعدة)
- **محايدة**: حاجة لمعالجة دقيقة للأخطاء

---

## قرار معماري #10: نظام التعليقات المتداخلة
**التاريخ:** 3 أغسطس 2025  
**الحالة:** مقبول ومطبق

### السياق
التعليقات تحتاج لدعم الردود لإنشاء محادثات منظمة ومفيدة.

### القرار
تم تطوير نظام تعليقات يدعم:
1. تعليقات رئيسية على الأوراق
2. ردود متداخلة بلا حدود
3. إعجابات على التعليقات والردود
4. عرض هرمي للمحادثات
5. إشعارات للردود والإعجابات

### المبررات
- **تفاعل أغنى**: محادثات منظمة ومفيدة
- **مرونة**: دعم مستويات متعددة من النقاش
- **وضوح**: هيكلة واضحة للمحادثات
- **مشاركة أكبر**: تشجيع النقاش العلمي

### البدائل المرفوضة
- تعليقات مسطحة فقط (أقل تنظيماً)
- حد أقصى لمستويات التداخل (أقل مرونة)
- عدم دعم الإعجاب على التعليقات (تفاعل أقل)

### العواقب
- **إيجابية**: محادثات علمية منظمة ومفيدة
- **إيجابية**: زيادة في مشاركة المستخدمين
- **سلبية**: تعقيد في عرض التعليقات (لكن مع تصميم جيد)
- **محايدة**: حاجة لإدارة دقيقة للأداء مع التعليقات الكثيرة



---

## القرار #007: تصميم نظام رفع الأوراق مع دعم الملفات
**التاريخ:** 2025-08-03  
**الحالة:** مقبول  

### السياق
نحتاج إلى نظام شامل لرفع الأوراق البحثية يدعم الملفات والبيانات الوصفية مع التحقق من الصحة.

### القرار
تطوير نظام رفع متدرج يشمل:
- نموذج شامل للبيانات الوصفية
- دعم رفع ملفات PDF مع التحقق من الحجم والصيغة
- حالات متعددة للأوراق (مسودة، مرسلة، قيد المراجعة، منشورة، مرفوضة)
- ربط تلقائي بالمؤلف الحالي

### المبررات
- **تجربة مستخدم محسنة**: نموذج واحد يجمع كل المعلومات المطلوبة
- **مرونة في الرفع**: دعم رفع الملف أو إدخال رابط خارجي
- **التحقق المبكر**: منع رفع ملفات غير صالحة قبل الإرسال
- **إدارة الحالات**: تتبع دورة حياة الورقة من المسودة إلى النشر
- **الأمان**: ربط الأوراق بالمؤلفين تلقائياً لمنع التلاعب

### البدائل المدروسة
- **رفع متعدد المراحل**: معقد للمستخدم ويزيد من معدل الهجر
- **رفع مباشر بدون تحقق**: يؤدي إلى مشاكل في الجودة
- **دعم صيغ متعددة**: يعقد النظام ويزيد من متطلبات التخزين

### العواقب
- تحسن كبير في جودة الأوراق المرفوعة
- تقليل الأخطاء والمشاكل التقنية
- سهولة إدارة المحتوى للمحررين
- إمكانية تتبع تقدم الأوراق

---

## القرار #008: تصميم نظام المراجعة الأكاديمية
**التاريخ:** 2025-08-03  
**الحالة:** مقبول  

### السياق
نحتاج إلى نظام مراجعة أكاديمي يحافظ على جودة المحتوى ويوفر تغذية راجعة قيمة للباحثين.

### القرار
تطوير نظام مراجعة متدرج يشمل:
- تقييم نجمي من 1 إلى 5
- مراجعة نصية مفصلة مع عنوان ومحتوى
- صلاحيات محددة للمراجعين (REVIEWER, EDITOR, ADMIN)
- منع المراجعة المتكررة من نفس المستخدم
- إشعارات تلقائية للمؤلفين

### المبررات
- **جودة المحتوى**: ضمان مراجعة الأوراق من خبراء مؤهلين
- **تغذية راجعة شاملة**: تقييم كمي ونوعي للأوراق
- **منع التلاعب**: صلاحيات محددة ومنع المراجعة المتكررة
- **الشفافية**: عرض المراجعات للجمهور لزيادة الثقة
- **التفاعل**: إمكانية التفاعل مع المراجعات (إعجاب، تعليق)

### البدائل المدروسة
- **مراجعة مجهولة**: تعقد النظام وتقلل من المساءلة
- **مراجعة مفتوحة للجميع**: تؤثر على جودة المراجعات
- **نظام تقييم معقد**: يصعب على المراجعين الاستخدام

### العواقب
- تحسن ملحوظ في جودة الأوراق المنشورة
- زيادة ثقة المجتمع العلمي في المنصة
- تطوير مجتمع من المراجعين المؤهلين
- تحسين مهارات الباحثين من خلال التغذية الراجعة

---

## القرار #009: تصميم لوحة تحكم المؤلف
**التاريخ:** 2025-08-03  
**الحالة:** مقبول  

### السياق
نحتاج إلى واجهة شاملة تمكن المؤلفين من إدارة أوراقهم ومتابعة الإحصائيات والتفاعل.

### القرار
تطوير لوحة تحكم متكاملة تشمل:
- جدول شامل لجميع أوراق المؤلف
- فلترة حسب الحالة والتاريخ
- إحصائيات تفصيلية (مشاهدات، إعجابات، تعليقات، مراجعات)
- روابط سريعة للعرض والتحميل والتحرير
- إحصائيات سريعة في الأعلى

### المبررات
- **إدارة مركزية**: مكان واحد لإدارة جميع الأوراق
- **رؤى قيمة**: إحصائيات تساعد المؤلفين على فهم تأثير أعمالهم
- **سهولة الوصول**: روابط سريعة للإجراءات الشائعة
- **تتبع التقدم**: متابعة حالة الأوراق في دورة المراجعة
- **تحفيز المؤلفين**: عرض الإنجازات والتفاعل

### البدائل المدروسة
- **صفحة بسيطة**: لا توفر رؤى كافية للمؤلفين
- **تكامل مع الملف الشخصي**: يعقد التنقل ويخلط بين الوظائف
- **لوحة تحكم معقدة**: تربك المستخدمين الجدد

### العواقب
- تحسن كبير في تجربة المؤلفين
- زيادة الاحتفاظ بالمستخدمين
- تشجيع المؤلفين على رفع المزيد من الأوراق
- تحسين جودة البيانات المدخلة

---

## القرار #010: تكامل المراجعات في صفحة تفاصيل الورقة
**التاريخ:** 2025-08-03  
**الحالة:** مقبول  

### السياق
نحتاج إلى دمج المراجعات والتعليقات في صفحة تفاصيل الورقة بطريقة منظمة وسهلة الاستخدام.

### القرار
تطوير نظام تبويبات يشمل:
- تبويب المحتوى: النص الكامل للورقة
- تبويب المراجعات: عرض وإضافة المراجعات
- تبويب التعليقات: التفاعل العام مع الورقة
- نموذج مراجعة مدمج للمراجعين المؤهلين

### المبررات
- **تنظيم المحتوى**: فصل واضح بين أنواع المحتوى المختلفة
- **سهولة التنقل**: تبويبات بديهية للمستخدمين
- **تحكم في الوصول**: عرض نموذج المراجعة للمؤهلين فقط
- **تجربة شاملة**: كل ما يحتاجه المستخدم في مكان واحد
- **قابلية التوسع**: سهولة إضافة تبويبات جديدة مستقبلاً

### البدائل المدروسة
- **صفحات منفصلة**: تعقد التنقل وتقلل من التفاعل
- **عرض خطي**: يجعل الصفحة طويلة جداً ومربكة
- **نوافذ منبثقة**: تؤثر على تجربة المستخدم على الأجهزة المحمولة

### العواقب
- تحسن كبير في تجربة قراءة الأوراق
- زيادة التفاعل مع المراجعات والتعليقات
- سهولة الوصول للمراجعين لإضافة مراجعاتهم
- تحسين تنظيم المحتوى العام للمنصة

---

## القرار #011: استراتيجية حماية الصفحات والصلاحيات
**التاريخ:** 2025-08-03  
**الحالة:** مقبول  

### السياق
نحتاج إلى نظام حماية شامل يضمن وصول المستخدمين المناسبين فقط للوظائف المخصصة لهم.

### القرار
تطوير نظام حماية متدرج يشمل:
- Middleware للحماية على مستوى التطبيق
- حماية صفحات رفع الأوراق للمستخدمين المسجلين
- حماية لوحة التحكم للمؤلفين
- صلاحيات مراجعة محددة للمراجعين والمحررين
- التحقق من ملكية الأوراق قبل العرض

### المبررات
- **الأمان**: منع الوصول غير المصرح به للوظائف الحساسة
- **جودة المحتوى**: ضمان أن المراجعات تأتي من خبراء مؤهلين
- **خصوصية البيانات**: حماية بيانات المؤلفين الشخصية
- **تجربة مخصصة**: عرض المحتوى المناسب لكل نوع مستخدم
- **قابلية التوسع**: نظام صلاحيات قابل للتطوير

### البدائل المدروسة
- **حماية على مستوى المكونات**: معقدة ومعرضة للأخطاء
- **نظام صلاحيات معقد**: صعب الإدارة والفهم
- **حماية أساسية فقط**: لا توفر المرونة المطلوبة

### العواقب
- تحسن كبير في أمان المنصة
- ثقة أكبر من المستخدمين في النظام
- سهولة إدارة الصلاحيات والأدوار
- مرونة في إضافة أنواع مستخدمين جديدة

---

## الدروس المستفادة

### ما نجح بشكل جيد
1. **التطوير التدريجي**: بناء النظام على مراحل سهل التطوير والاختبار
2. **التحقق المبكر**: منع المشاكل قبل وصولها لقاعدة البيانات
3. **واجهات بديهية**: تصميم يركز على تجربة المستخدم
4. **نظام صلاحيات مرن**: سهولة إضافة أدوار جديدة

### التحديات المواجهة
1. **تعقيد العلاقات**: إدارة العلاقات المعقدة بين الكيانات
2. **التحقق من الصلاحيات**: ضمان التحقق في جميع النقاط المناسبة
3. **تجربة المستخدم**: توازن بين الوظائف والبساطة

### التحسينات المستقبلية
1. **تكامل AWS S3**: رفع ملفات فعلي بدلاً من المحاكاة
2. **نظام إشعارات متقدم**: إشعارات فورية ومخصصة
3. **تحليلات متقدمة**: رؤى أعمق للمؤلفين والمحررين
4. **نظام بحث ذكي**: بحث متقدم مع فلاتر ذكية



## قرار معماري: نظام البحث المتقدم والتصنيف الذكي
**التاريخ:** 4 أغسطس 2025  
**المطور:** Manus AI Agent

### السياق
تطوير نظام بحث متقدم وتصنيف ذكي للباحثين في منصة Arabic Science Hub لتحسين تجربة اكتشاف المحتوى العلمي.

### القرارات المتخذة

#### 1. هيكلة APIs
- **القرار**: إنشاء router منفصل `discovery.ts` للبحث والتصنيف
- **المبرر**: فصل الاهتمامات وتسهيل الصيانة
- **البدائل المرفوضة**: دمج في routers موجودة (papers, users)

#### 2. خوارزمية التصنيف
- **القرار**: نظام نقاط مرجح يعتمد على:
  - الأوراق المنشورة (10 نقاط)
  - المراجعات (5 نقاط)
  - الإعجابات (2 نقطة)
  - متوسط التقييم (20 × المتوسط)
- **المبرر**: توازن بين الكمية والجودة
- **البدائل المرفوضة**: نظام ترتيب بسيط حسب عدد الأوراق فقط

#### 3. البحث المتقدم
- **القرار**: دعم البحث النصي مع فلاتر متعددة
- **المبرر**: مرونة في البحث وتجربة مستخدم محسنة
- **التقنية**: استخدام Prisma `contains` مع `mode: "insensitive"`

#### 4. مكونات UI
- **القرار**: إنشاء مكونات UI بسيطة بدلاً من Radix UI
- **المبرر**: تجنب تعقيدات التبعيات وتحسين الأداء
- **البدائل المرفوضة**: استخدام مكتبات UI معقدة

#### 5. هيكلة الصفحات
- **القرار**: صفحات منفصلة للبحث والتصنيف وملفات الباحثين
- **المبرر**: تجربة مستخدم محسنة وتنظيم أفضل للمحتوى
- **المسارات**:
  - `/papers/search` - البحث المتقدم
  - `/ranking` - تصنيف الباحثين
  - `/researcher/[id]` - ملف الباحث

### التأثير على النظام
- **الأداء**: تحسن في سرعة البحث والاستعلامات
- **قابلية التوسع**: سهولة إضافة معايير بحث جديدة
- **تجربة المستخدم**: واجهة بحث متقدمة وتصنيف تفاعلي
- **الصيانة**: كود منظم وقابل للصيانة

### المخاطر والتخفيف
- **المخاطر**: استهلاك قاعدة البيانات مع البحث المعقد
- **التخفيف**: إضافة فهارس محسنة وcaching لاحقاً

### الخطوات التالية
- تحسين الأداء مع نمو البيانات
- إضافة تحليلات استخدام البحث
- تطوير خوارزمية تصنيف أكثر تطوراً

